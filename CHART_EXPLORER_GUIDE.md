# Market Chart Explorer Guide

## Overview

The Market Chart Explorer is an interactive CLI tool that lets you browse Polymarket markets and visualize their historical price data directly in the terminal using beautiful ASCII charts.

## Quick Start

```bash
# Run the interactive explorer
uv run python market_chart_explorer.py
```

## Features

### 1. Browse Markets
- Load markets from `data/crypto_markets_cache.csv`
- View up to 50 markets at a time in a formatted table
- See market ID, question, volume, and status at a glance

### 2. Search & Filter
- **Search by keyword**: Find markets containing specific terms
- **Filter by status**: Show only open or closed markets
- Narrow down 7,000+ markets to find what you need

### 3. View Market Details
- Full market information display
- Outcome labels (Up/Down, Yes/No, etc.)
- Token IDs for both outcomes
- Volume, creation date, and closure time
- Market status (Open/Closed)

### 4. Historical Price Charts
- Fetch price history for both market tokens
- Choose time range:
  - **1h**: Last hour
  - **6h**: Last 6 hours
  - **1d**: Last day
  - **1w**: Last week
  - **max**: All available data
- Dual-line chart showing both outcomes:
  - **Green**: First outcome (e.g., "Up", "Yes")
  - **Red**: Second outcome (e.g., "Down", "No")
- Automatic terminal size detection
- Price statistics (range, latest values)

### 5. Export Market Info
- Export market details to text file
- Format: `market_{ID}_info.txt`
- Includes all metadata and token IDs

## Demo Output

Here's what a successful chart looks like:

```
Bitcoin Up or Down - December 25, 5:30PM-5:45PM ET (1d)
      ┌──────────────────────────────────────────────────────────────┐
0.5050┤ •• Up   ••••••••••••••••••••••••   ••••••••••••••••••••••    │
0.5017┤ •• Down                         •  •                      ••••│
0.4983┤                                  •                        •• │
0.4950┤••••••••••••••••••••••••••••••••• ••••••••••••••••••••••••   │
      └┬──────────────────────────────┬─────────────────────────────┬┘
   2025-12-24 23:00:10        2025-12-25 07:30:13 2025-12-25 16:00:16
```

**Reading the chart:**
- **Green dots (••)**: "Up" outcome price movement
- **Red dots (••)**: "Down" outcome price movement
- **Y-axis**: Price ($0.4950 to $0.5050 range)
- **X-axis**: Time (24 hours in this example)

## Usage Examples

### Interactive Mode

1. **Start the explorer:**
   ```bash
   uv run python market_chart_explorer.py
   ```

2. **Main Menu:**
   ```
   MAIN MENU
   ═══════════════════════════════════════════════════════════
     1) Browse all markets
     2) Search by keyword
     3) Filter by status (open/closed)
     0) Exit
   ```

3. **Select a market** from the list (enter number 1-50)

4. **Choose an action:**
   ```
   ACTIONS:
     1) View price chart
     2) Export market info
     0) Back to market list
   ```

5. **For charting**, select time range:
   ```
   Select time range:
     1) Last hour (1h)
     2) Last 6 hours (6h)
     3) Last day (1d)
     4) Last week (1w)
     5) All available data (max)
   ```

### Programmatic Testing

Run the demo script to test a specific market:

```bash
uv run python test_chart_demo.py
```

This will:
- Load markets from cache
- Find market ID 1013904 (Bitcoin Up/Down)
- Fetch price history for last 24 hours
- Render the chart
- Display statistics

## Technical Details

### Data Source

- **Market cache**: `data/crypto_markets_cache.csv` (generated by `crypto_market_finder.py`)
- **Price data**: Fetched from Polymarket CLOB API `/prices-history` endpoint
- **No authentication required** for historical price data

### Price History API

The tool uses the `price_history.py` module which calls:

```
GET https://clob.polymarket.com/prices-history
Parameters:
  - market: <TOKEN_ID>
  - interval: 1h|6h|1d|1w|max
  - fidelity: resolution in minutes (optional)
```

Returns:
```json
{
  "history": [
    {"t": 1735160410, "p": 0.5050},
    {"t": 1735164010, "p": 0.5000},
    ...
  ]
}
```

Where:
- `t` = Unix timestamp (seconds)
- `p` = Price value (0.0 to 1.0)

### Chart Rendering

- **Library**: `plotext` (terminal plotting library)
- **Auto-sizing**: Detects terminal dimensions
- **Color support**: Green for first outcome, red for second
- **Date formatting**: Automatic date axis with `YYYY-MM-DD HH:MM:SS`

## Data Availability

**Note**: Price history may not be available for all markets.

✅ **Works well for:**
- Active markets with recent trading
- Resolved markets from the last few weeks
- High-volume markets

⚠️ **May have limited data for:**
- Very new markets (no accumulated data)
- Very old markets (data purged)
- Low-volume markets (sparse price updates)

If no data is returned:
- Try `interval: max` to see what's available
- Check market has trading volume
- Verify market is not brand new

## Examples

### Example 1: Bitcoin Short-Term Market

**Market**: "Bitcoin Up or Down - December 25, 5:30PM-5:45PM ET"
- **ID**: 1013904
- **Volume**: $115,365.83
- **Status**: Closed
- **Data points**: 18 per outcome (hourly resolution)
- **Price range**: $0.4950 - $0.5050
- **Result**: Chart shows tight price range, indicating uncertainty

### Example 2: Finding Active Markets

```bash
# Start explorer
uv run python market_chart_explorer.py

# Choose option 3: Filter by status
# Select "1" for open markets only
# Browse active markets
# Select one to chart
# Choose "1" for 1-hour history to see recent action
```

### Example 3: Searching for Specific Asset

```bash
# Start explorer
uv run python market_chart_explorer.py

# Choose option 2: Search by keyword
# Enter: "ethereum"
# Browse Ethereum-related markets
# Select one to view price history
```

## Integration with Other Tools

The chart explorer works alongside other project tools:

```bash
# 1. Find crypto markets and populate cache
uv run python crypto_market_finder.py --unresolved --short-term

# 2. Browse and chart markets from cache
uv run python market_chart_explorer.py

# 3. Monitor a specific market live
uv run python live_monitor.py --token-up <ID1> --token-down <ID2>

# 4. Fetch raw price data programmatically
uv run python price_history.py --market-id <ID> --interval 1w --output prices.csv
```

## Next Steps

This tool demonstrates the charting and navigation capabilities planned for the full TUI application. The next phase will integrate:

1. **Textual framework** for reactive UI
2. **Multiple pages** (Market Browser, Live Monitor, Price Charts)
3. **Real-time updates** via WebSocket
4. **Advanced filtering** with user-configurable params
5. **Better visualization** with more chart types

For now, enjoy experimenting with the interactive explorer!

## Troubleshooting

**"Could not load markets from cache"**
- Run `uv run python crypto_market_finder.py --all` to populate the cache

**"No price data available"**
- Market may be too new or too old
- Try different time intervals (1h, 6h, 1d, 1w, max)
- Check market has trading volume

**"Chart looks cramped"**
- Resize your terminal window
- The chart auto-detects terminal size
- Recommend 120+ columns width for best results

**"Colors not showing"**
- Ensure terminal supports ANSI colors
- Most modern terminals do (iTerm2, Terminal.app, etc.)
- The chart uses green/red color codes for clarity
